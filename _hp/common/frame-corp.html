<!DOCTYPE html>
<html>
	<head>
	</head>
	<body>
		<script>
		var urlParams = new URLSearchParams(decodeURIComponent(window.location.search));
		var id = urlParams.get("count");
        let url = urlParams.get("origin") + '/_hp/server/responses.py?feature_group=corp&resp_id=';
        let origin = urlParams.get("origin");
        let nest = urlParams.get("nest")-1;
        let response_id = urlParams.get("resp_id");
        let element = urlParams.get("element");
		if (urlParams.get("nest") == 1) {
            const i = document.createElement(element);
            i.onload = () => {
                window.parent.postMessage(id, "*");
            }
            i.onerror = () => {
                window.parent.postMessage(id, "*");
            }
            i.src = url + response_id + `&nest=0`;
            document.body.appendChild(i);
		} else {
			window.addEventListener("message", (e) => {
				window.parent.postMessage(e.data, "*");
			  });
			const i = document.createElement('iframe');
			const final_url = url + response_id + `&count=${id}&nest=${nest}&origin=${origin}&element=${element}`;
			i.src = final_url;
			i.data = final_url;
			document.body.append(i);
		}
		</script>
	</body>
</html>